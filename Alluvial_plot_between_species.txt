# make_separate_by_state.sh

## 1 ## Separate CS13-12383 by state
# using hg19 coordinates that have been lifted to mm10 and lifted back to hg19 (reciprocal lift to show that present in both genomes)

cd /home/FCAM/awilderman/ANALYSIS/Human_18_state_liftover/Craniofacial
for CFILE in \
CS13-12383 \
CS13-12690 \
CS13-12829 \
CS13-12830 \
CS13-12877 \
CS14-12408 \
CS14-12709 \
CS14-12913 \
CS15-13000 \
CS15-13019 \
CS15-13128 \
CS17-12191 \
CS17-12331 \
CS17-12341 \
CS17-12611 \
CS20-12104 \
F2-N2108;
do
    echo "cd /home/FCAM/awilderman/ANALYSIS/Human_18_state_liftover/Craniofacial 
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 1_TssA | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t1_TssA_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_1_TssA
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 2_TssFlnk | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t2_TssFlnk_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_2_TssFlnk
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 3_TssFlnkU | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t3_TssFlnkU_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_3_TssFlnkU
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 4_TssFlnkD | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t4_TssFlnkD_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_4_TssFlnkD
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 5_Tx | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t5_Tx_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_5_Tx
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 6_TxWk | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t6_TxWk_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_6_TxWk
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 7_EnhG1 | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t7_EnhG1_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_7_EnhG1
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 8_EnhG2 | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t8_EnhG2_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_8_EnhG2
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 9_EnhA1 | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t9_EnhA1_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_9_EnhA1
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 10_EnhA2 | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t10_EnhA2_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_10_EnhA2
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 11_EnhWk | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t11_EnhWk_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_11_EnhWk
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 12_ZNF/Rpts | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t12_ZNFRpts_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_12_ZNFRpts
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 13_Het | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t13_Het_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_13_Het
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 14_TssBiv | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t14_TssBiv_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_14_TssBiv
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 15_EnhBiv | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t15_EnhBiv_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_15_EnhBiv
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 16_ReprPC | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t16_ReprPC_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_16_ReprPC
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 17_ReprPCWk | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t17_ReprPCWk_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_17_ReprPCWk
    cat "$CFILE"_18state.hg19_to_mm10_to_hg19.bed | grep 18_Quies | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t18_Quies_hg19_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$CFILE"_18state_18_Quies" >> separate_hg19_CF_samples_by_state.sh 
done

# 
cd /home/FCAM/awilderman/ANALYSIS/Human_18_state_liftover/Craniofacial/separated_by_state

for CFILE in \
CS13-12383 \
CS13-12690 \
CS13-12829 \
CS13-12830 \
CS13-12877 \
CS14-12408 \
CS14-12709 \
CS14-12913 \
CS15-13000 \
CS15-13019 \
CS15-13128 \
CS17-12191 \
CS17-12331 \
CS17-12341 \
CS17-12611 \
CS20-12104 \
F2-N2108;
do
    echo "cat "$CFILE"* > "$CFILE"_states_for_intersect.bed" >> make_files_for_intersect.sh
done

## 2 ## separate mouse embryonic CF tissue samples by state
# using mm10 coordinates that have been lifted to hg19 and lifted back to mm10 before lifting to hg19 again (reciprocal lift to show that present in both genomes)

cd /home/FCAM/awilderman/ANALYSIS/Mouse_18_state_Liftover/All_Tissues

for FILE in \
embryonic_10.5_day_craniofacial_rep1 \
embryonic_10.5_day_craniofacial_rep2 \
embryonic_10.5_day_embryonic-facial-prominence_rep1 \
embryonic_10.5_day_embryonic-facial-prominence_rep2 \
embryonic_11.5_day_craniofacial_rep1 \
embryonic_11.5_day_craniofacial_rep2 \
embryonic_11.5_day_craniofacial_rep3 \
embryonic_11.5_day_craniofacial_rep4 \
embryonic_12.5_day_embryonic-facial-prominence_rep1 \
embryonic_12.5_day_embryonic-facial-prominence_rep2 \
embryonic_13.5_day_embryonic-facial-prominence_rep1 \
embryonic_13.5_day_embryonic-facial-prominence_rep2 \
embryonic_14.5_day_embryonic-facial-prominence_rep1 \
embryonic_14.5_day_embryonic-facial-prominence_rep2 \
embryonic_15.5_day_embryonic-facial-prominence_rep1 \
embryonic_15.5_day_embryonic-facial-prominence_rep2 \
embryonic_9.5_day_embryonic_Rep1 \
embryonic_9.5_day_embryonic_Rep2 \
embryonic_10.5_day_hindbrain_rep1 \
embryonic_10.5_day_hindbrain_rep2 \
embryonic_11.5_day_hindbrain_rep1 \
embryonic_11.5_day_hindbrain_rep2 \
embryonic_12.5_day_hindbrain_rep1 \
embryonic_12.5_day_hindbrain_rep2 \
embryonic_13.5_day_hindbrain_rep1 \
embryonic_13.5_day_hindbrain_rep2 \
embryonic_14.5_day_hindbrain_rep1 \
embryonic_14.5_day_hindbrain_rep2 \
embryonic_15.5_day_hindbrain_rep1 \
embryonic_15.5_day_hindbrain_rep2;
do
    echo "cd /home/FCAM/awilderman/ANALYSIS/Mouse_18_state_Liftover/All_Tissues
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 1_TssA | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t1_TssA_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_1_TssA
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 2_TssFlnk | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t2_TssFlnk_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_2_TssFlnk
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 3_TssFlnkU | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t3_TssFlnkU_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_3_TssFlnkU
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 4_TssFlnkD | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t4_TssFlnkD_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_4_TssFlnkD
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 5_Tx | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t5_Tx_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_5_Tx
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 6_TxWk | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t6_TxWk_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_6_TxWk
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 7_EnhG1 | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t7_EnhG1_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_7_EnhG1
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 8_EnhG2 | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t8_EnhG2_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_8_EnhG2
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 9_EnhA1 | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t9_EnhA1_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_9_EnhA1
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 10_EnhA2 | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t10_EnhA2_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_10_EnhA2
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 11_EnhWk | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t11_EnhWk_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_11_EnhWk
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 12_ZNF/Rpts | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t12_ZNFRpts_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_12_ZNFRpts
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 13_Het | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t13_Het_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_13_Het
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 14_TssBiv | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t14_TssBiv_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_14_TssBiv
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 15_EnhBiv | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t15_EnhBiv_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_15_EnhBiv
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 16_ReprPC | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t16_ReprPC_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_16_ReprPC
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 17_ReprPCWk | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t17_ReprPCWk_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_17_ReprPCWk
    cat "$FILE"_18state.reciprocal_to_hg19.bed | grep 18_Quies | awk '{print \$1\"\t\"\$2\"\t\"\$3\"\t18_Quies_mm10_\"\$1\"_\"\$2\"_\"\$3}' > separated_by_state/"$FILE"_18state_18_Quies" >> separate_mm10_CF_samples_by_state.sh 
done

#
cd /home/FCAM/awilderman/ANALYSIS/Mouse_18_state_Liftover/All_Tissues/separated_by_state

for FILE in \
embryonic_10.5_day_craniofacial_rep1 \
embryonic_10.5_day_craniofacial_rep2 \
embryonic_10.5_day_embryonic-facial-prominence_rep1 \
embryonic_10.5_day_embryonic-facial-prominence_rep2 \
embryonic_11.5_day_craniofacial_rep1 \
embryonic_11.5_day_craniofacial_rep2 \
embryonic_11.5_day_craniofacial_rep3 \
embryonic_11.5_day_craniofacial_rep4 \
embryonic_12.5_day_embryonic-facial-prominence_rep1 \
embryonic_12.5_day_embryonic-facial-prominence_rep2 \
embryonic_13.5_day_embryonic-facial-prominence_rep1 \
embryonic_13.5_day_embryonic-facial-prominence_rep2 \
embryonic_14.5_day_embryonic-facial-prominence_rep1 \
embryonic_14.5_day_embryonic-facial-prominence_rep2 \
embryonic_15.5_day_embryonic-facial-prominence_rep1 \
embryonic_15.5_day_embryonic-facial-prominence_rep2 \
embryonic_9.5_day_embryonic_Rep1 \
embryonic_9.5_day_embryonic_Rep2 \
embryonic_10.5_day_hindbrain_rep1 \
embryonic_10.5_day_hindbrain_rep2 \
embryonic_11.5_day_hindbrain_rep1 \
embryonic_11.5_day_hindbrain_rep2 \
embryonic_12.5_day_hindbrain_rep1 \
embryonic_12.5_day_hindbrain_rep2 \
embryonic_13.5_day_hindbrain_rep1 \
embryonic_13.5_day_hindbrain_rep2 \
embryonic_14.5_day_hindbrain_rep1 \
embryonic_14.5_day_hindbrain_rep2 \
embryonic_15.5_day_hindbrain_rep1 \
embryonic_15.5_day_hindbrain_rep2;
do
    echo "cat "$FILE"* > "$FILE"_states_for_intersect.bed" >> make_files_for_intersect.sh
done

## end of make_separate_by_state.sh

## 3 ## Intersect CS13-12383 with mouse states at a range of stages to find conserved or different states, and hindbrain as outgroup
# replace with other reps of CS13 or other Carnegie Stage samples

cd /home/FCAM/awilderman/ANALYSIS/Human_18_state_liftover/Craniofacial/separated_by_state

#### CS13-12383_compare_to_mouse_CF.slurm

#!/bin/bash
#SBATCH --job-name=CS13-12383_lifted_comparisons
#SBATCH -N 1
#SBATCH -n 1
#SBATCH -c 8
#SBATCH --partition=general
#SBATCH --qos=general
#SBATCH --mem=32G
#SBATCH --mail-type=BEGIN,END
#SBATCH --mail-user=awilderman@uchc.edu
#SBATCH -o CS13-12383_comparisons_%j.out
#SBATCH -e CS13-12383_comparisons_%j.err

cd /home/FCAM/awilderman/ANALYSIS/Human_18_state_liftover/Craniofacial/separated_by_state

module load BEDtools/2.29.0
module load libpng/12-1.2.50-10

export MOUSEDIR=/home/FCAM/awilderman/ANALYSIS/Mouse_18_state_Liftover/All_Tissues/separated_by_state
mkdir CS13-12383_comparisons
export OUTDIR=/home/FCAM/awilderman/ANALYSIS/Human_18_state_liftover/Craniofacial/separated_by_state/CS13-12383_comparisons

##### add to the slurm script with these commands


for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_9.5_day_embryonic_Rep1_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_9.5_day_embryonic_Rep1.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_9.5_day_embryonic_Rep2_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_9.5_day_embryonic_Rep2.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_10.5_day_craniofacial_rep1_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_10.5_day_embryonic_rep1.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_10.5_day_craniofacial_rep2_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_10.5_day_embryonic_rep2.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_10.5_day_embryonic-facial-prominence_rep1_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_10.5_day_embryonic_rep3.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_10.5_day_embryonic-facial-prominence_rep2_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_10.5_day_embryonic_rep4.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_11.5_day_craniofacial_rep1_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_11.5_day_embryonic_rep1.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_11.5_day_craniofacial_rep2_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_11.5_day_embryonic_rep2.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_11.5_day_craniofacial_rep3_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_11.5_day_embryonic_rep3.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_11.5_day_craniofacial_rep4_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_11.5_day_embryonic_rep4.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_12.5_day_embryonic-facial-prominence_rep1_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_12.5_day_embryonic_rep1.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_12.5_day_embryonic-facial-prominence_rep2_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_12.5_day_embryonic_rep2.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_13.5_day_embryonic-facial-prominence_rep1_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_13.5_day_embryonic_rep1.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_13.5_day_embryonic-facial-prominence_rep2_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_13.5_day_embryonic_rep2.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_14.5_day_embryonic-facial-prominence_rep1_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_14.5_day_embryonic_rep1.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_14.5_day_embryonic-facial-prominence_rep2_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_14.5_day_embryonic_rep2.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_15.5_day_embryonic-facial-prominence_rep1_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_15.5_day_embryonic_rep1.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_15.5_day_embryonic-facial-prominence_rep2_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_15.5_day_embryonic_rep2.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_10.5_day_hindbrain_rep1_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_10.5_day_hindbrain_rep1.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_10.5_day_hindbrain_rep2_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_10.5_day_hindbrain_rep2.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_11.5_day_hindbrain_rep1_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_11.5_day_hindbrain_rep1.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_11.5_day_hindbrain_rep2_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_11.5_day_hindbrain_rep2.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_12.5_day_hindbrain_rep1_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_12.5_day_hindbrain_rep1.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_12.5_day_hindbrain_rep2_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_12.5_day_hindbrain_rep2.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_13.5_day_hindbrain_rep1_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_13.5_day_hindbrain_rep1.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_13.5_day_hindbrain_rep2_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_13.5_day_hindbrain_rep2.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_14.5_day_hindbrain_rep1_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_14.5_day_hindbrain_rep1.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_14.5_day_hindbrain_rep2_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_14.5_day_hindbrain_rep2.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_15.5_day_hindbrain_rep1_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_15.5_day_hindbrain_rep1.bed
    bedtools intersect -a CS13-12383_18state_"$STATE" -b \$MOUSEDIR/embryonic_15.5_day_hindbrain_rep2_states_for_intersect.bed -f 0.60 -wo > \$OUTDIR/CS13-12383_"$STATE"_successful_intersect_on_15.5_day_hindbrain_rep2.bed" >> CS13-12383_compare_to_mouse_CF.slurm
done


##########
echo "cd /home/FCAM/awilderman/ANALYSIS/Human_18_state_liftover/Craniofacial/separated_by_state/CS13-12383_comparisons" >> CS13-12383_compare_to_mouse_CF.slurm

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_9.5_day_embryonic_Rep1.bed | sort | uniq > CS13-12383_"$STATE"_9.5_rep1_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_9.5_day_embryonic_Rep2.bed | sort | uniq > CS13-12383_"$STATE"_9.5_rep2_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_10.5_day_embryonic_rep1.bed | sort | uniq > CS13-12383_"$STATE"_10.5_rep1_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_10.5_day_embryonic_rep2.bed | sort | uniq > CS13-12383_"$STATE"_10.5_rep2_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_10.5_day_embryonic_rep3.bed | sort | uniq > CS13-12383_"$STATE"_10.5_rep3_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_10.5_day_embryonic_rep4.bed | sort | uniq > CS13-12383_"$STATE"_10.5_rep4_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_11.5_day_embryonic_rep1.bed | sort | uniq > CS13-12383_"$STATE"_11.5_rep1_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_11.5_day_embryonic_rep2.bed | sort | uniq > CS13-12383_"$STATE"_11.5_rep2_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_11.5_day_embryonic_rep3.bed | sort | uniq > CS13-12383_"$STATE"_11.5_rep3_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_11.5_day_embryonic_rep4.bed | sort | uniq > CS13-12383_"$STATE"_11.5_rep4_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_12.5_day_embryonic_rep1.bed | sort | uniq > CS13-12383_"$STATE"_12.5_rep1_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_12.5_day_embryonic_rep2.bed | sort | uniq > CS13-12383_"$STATE"_12.5_rep2_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_13.5_day_embryonic_rep1.bed | sort | uniq > CS13-12383_"$STATE"_13.5_rep1_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_13.5_day_embryonic_rep2.bed | sort | uniq > CS13-12383_"$STATE"_13.5_rep2_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_14.5_day_embryonic_rep1.bed | sort | uniq > CS13-12383_"$STATE"_14.5_rep1_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_14.5_day_embryonic_rep2.bed | sort | uniq > CS13-12383_"$STATE"_14.5_rep2_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_15.5_day_embryonic_rep1.bed | sort | uniq > CS13-12383_"$STATE"_15.5_rep1_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_15.5_day_embryonic_rep2.bed | sort | uniq > CS13-12383_"$STATE"_15.5_rep2_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_10.5_day_hindbrain_rep1.bed | sort | uniq > CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_10.5_day_hindbrain_rep2.bed | sort | uniq > CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_11.5_day_hindbrain_rep1.bed | sort | uniq > CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_11.5_day_hindbrain_rep2.bed | sort | uniq > CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_12.5_day_hindbrain_rep1.bed | sort | uniq > CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_12.5_day_hindbrain_rep2.bed | sort | uniq > CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_13.5_day_hindbrain_rep1.bed | sort | uniq > CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_13.5_day_hindbrain_rep2.bed | sort | uniq > CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_14.5_day_hindbrain_rep1.bed | sort | uniq > CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_14.5_day_hindbrain_rep2.bed | sort | uniq > CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_15.5_day_hindbrain_rep1.bed | sort | uniq > CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt
    cut -f 8 CS13-12383_"$STATE"_successful_intersect_on_15.5_day_hindbrain_rep2.bed | sort | uniq > CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt" >> CS13-12383_compare_to_mouse_CF.slurm
done

## end of slurm script



for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\` >> CS13-12383_9.5_rep1.stats   
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\` >> CS13-12383_9.5_rep1.stats
    cat CS13-12383_"$STATE"_9.5_rep1_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\` >> CS13-12383_9.5_rep1.stats" >> make_9.5_rep1_stats.sh 
 done
   
for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats
    cat CS13-12383_"$STATE"_9.5_rep2_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_9.5_rep2.stats" >> make_9.5_rep2_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do   
    echo "cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats
    cat CS13-12383_"$STATE"_10.5_rep1_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_10.5_rep1.stats" >> make_10.5_rep1_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats
    cat CS13-12383_"$STATE"_10.5_rep2_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_10.5_rep2.stats" >> make_10.5_rep2_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats
    cat CS13-12383_"$STATE"_10.5_rep3_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_10.5_rep3.stats" >> make_10.5_rep3_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats
    cat CS13-12383_"$STATE"_10.5_rep4_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_10.5_rep4.stats" >> make_10.5_rep4_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats
    cat CS13-12383_"$STATE"_11.5_rep1_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_11.5_rep1.stats" >> make_11.5_rep1_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats
    cat CS13-12383_"$STATE"_11.5_rep2_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_11.5_rep2.stats" >> make_11.5_rep2_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats
    cat CS13-12383_"$STATE"_11.5_rep3_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_11.5_rep3.stats" >> make_11.5_rep3_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats
    cat CS13-12383_"$STATE"_11.5_rep4_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_11.5_rep4.stats" >> make_11.5_rep4_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats
    cat CS13-12383_"$STATE"_12.5_rep1_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_12.5_rep1.stats" >> make_12.5_rep1_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats
    cat CS13-12383_"$STATE"_12.5_rep2_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_12.5_rep2.stats" >> make_12.5_rep2_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats
    cat CS13-12383_"$STATE"_13.5_rep1_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_13.5_rep1.stats" >> make_13.5_rep1_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats
    cat CS13-12383_"$STATE"_13.5_rep2_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_13.5_rep2.stats" >> make_13.5_rep2_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats
    cat CS13-12383_"$STATE"_14.5_rep1_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_14.5_rep1.stats" >> make_14.5_rep1_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats
    cat CS13-12383_"$STATE"_14.5_rep2_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_14.5_rep2.stats" >> make_14.5_rep2_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats
    cat CS13-12383_"$STATE"_15.5_rep1_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_15.5_rep1.stats" >> make_15.5_rep1_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats
    cat CS13-12383_"$STATE"_15.5_rep2_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_15.5_rep2.stats" >> make_14.5_rep2_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep1_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1.stats" >> make_10.5_hindbrain_rep1_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_10.5_day_hindbrain_rep2_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2.stats" >> make_10.5_hindbrain_rep2_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep1_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1.stats" >> make_11.5_hindbrain_rep1_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_11.5_day_hindbrain_rep2_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2.stats" >> make_11.5_hindbrain_rep2_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep1_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1.stats" >> make_12.5_hindbrain_rep1_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_12.5_day_hindbrain_rep2_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2.stats" >> make_12.5_hindbrain_rep2_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep1_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1.stats" >> make_13.5_hindbrain_rep1_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_13.5_day_hindbrain_rep2_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2.stats" >> make_13.5_hindbrain_rep2_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep1_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1.stats" >> make_14.5_hindbrain_rep1_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_14.5_day_hindbrain_rep2_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2.stats" >> make_14.5_hindbrain_rep2_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do   
	echo "cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep1_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1.stats" >> make_15.5_hindbrain_rep1_stats.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 1_TssA | echo \""$STATE" 1_TssA \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 2_TssFlnk | echo \""$STATE" 2_TssFlnk \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 3_TssFlnkU | echo \""$STATE" 3_TssFlnkU \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 4_TssFlnkD | echo \""$STATE" 4_TssFlnkD \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 5_Tx | echo \""$STATE" 5_Tx \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 6_TxWk | echo \""$STATE" 6_TxWk \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 7_EnhG1 | echo \""$STATE" 7_EnhG1 \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 8_EnhG2 | echo \""$STATE" 8_EnhG2 \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 9_EnhA1 | echo \""$STATE" 9_EnhA1 \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 10_EnhA2 | echo \""$STATE" 10_EnhA2 \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 11_EnhWk | echo \""$STATE" 11_EnhWk \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 12_ZNFRpts | echo \""$STATE" 12_ZNFRpts \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 13_Het | echo \""$STATE" 13_Het \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 14_TssBiv | echo \""$STATE" 14_TssBiv \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 15_EnhBiv | echo \""$STATE" 15_EnhBiv \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 16_ReprPC | echo \""$STATE" 16_ReprPC \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 17_ReprPCWk | echo \""$STATE" 17_ReprPCWk \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats
    cat CS13-12383_"$STATE"_15.5_day_hindbrain_rep2_intersect.txt | grep 18_Quies | echo \""$STATE" 18_Quies \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2.stats" >> make_15.5_hindbrain_rep2_stats.sh
done

chmod +x *.sh
ls -1 *sh > run_make_states.sh
cat run_make_states.sh | awk '{print "./"$1}'

## 5 ## make alluvial plots

# may be easiest to copy the stats files to desktop and use R studio to see the results ASAP

setwd("/Users/awilderman/Documents/GitHub/Alluvial_plot_creation/")
library("ggplot2")
library("ggalluvial")

# info that may be useful
states <- c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNF/Rpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"  )
colors_by_state <- c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")

# load data
CS13_12383_9.5_rep1 <- read.table("CS13-12383_9.5_rep1.stats", header=FALSE)
colnames(CS13_12383_9.5_rep1) <- c("CS13_12383", "E9.5_rep1", "Frequency")
head(CS13_12383_9.5_rep1)

# specify order in columns by state number
CS13_12383_9.5_rep1$CS13_12383 <- factor(CS13_12383_9.5_rep1$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_9.5_rep1$E9.5_rep1 <- factor(CS13_12383_9.5_rep1$E9.5_rep1, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscfE9.5_compare.pdf")
ggplot(as.data.frame(CS13_12383_9.5_rep1),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E9.5_rep1)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E9.5_rep1")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E9.5_rep1")
dev.off()
####

CS13_12383_9.5_rep2 <- read.table("CS13-12383_9.5_rep2.stats", header=FALSE)
colnames(CS13_12383_9.5_rep2) <- c("CS13_12383", "E9.5_rep2", "Frequency")
head(CS13_12383_9.5_rep2)

# specify order in columns by state number
CS13_12383_9.5_rep2$CS13_12383 <- factor(CS13_12383_9.5_rep2$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_9.5_rep2$E9.5_rep2 <- factor(CS13_12383_9.5_rep2$E9.5_rep2, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscfE9.5_rep2_compare.pdf")
ggplot(as.data.frame(CS13_12383_9.5_rep2),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E9.5_rep2)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E9.5_rep2")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E9.5_rep2")
dev.off()
####

CS13_12383_10.5_rep1 <- read.table("CS13-12383_10.5_rep1.stats", header=FALSE)
colnames(CS13_12383_10.5_rep1) <- c("CS13_12383", "E10.5_rep1", "Frequency")
head(CS13_12383_10.5_rep1)

# specify order in columns by state number
CS13_12383_10.5_rep1$CS13_12383 <- factor(CS13_12383_10.5_rep1$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_10.5_rep1$E10.5_rep1 <- factor(CS13_12383_10.5_rep1$E10.5_rep1, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf10.5_rep1_compare.pdf")
ggplot(as.data.frame(CS13_12383_10.5_rep1),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E10.5_rep1)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E10.5_rep1")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E10.5_rep1")
dev.off()
####

CS13_12383_10.5_rep2 <- read.table("CS13-12383_10.5_rep2.stats", header=FALSE)
colnames(CS13_12383_10.5_rep2) <- c("CS13_12383", "E10.5_rep2", "Frequency")
head(CS13_12383_10.5_rep2)

# specify order in columns by state number
CS13_12383_10.5_rep2$CS13_12383 <- factor(CS13_12383_10.5_rep2$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_10.5_rep2$E10.5_rep2 <- factor(CS13_12383_10.5_rep2$E10.5_rep2, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf10.5_rep2_compare.pdf")
ggplot(as.data.frame(CS13_12383_10.5_rep2),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E10.5_rep2)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E10.5_rep2")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E10.5_rep2")
dev.off()
####

CS13_12383_10.5_rep3 <- read.table("CS13-12383_10.5_rep3.stats", header=FALSE)
colnames(CS13_12383_10.5_rep3) <- c("CS13_12383", "E10.5_rep3", "Frequency")
head(CS13_12383_10.5_rep3)

# specify order in columns by state number
CS13_12383_10.5_rep3$CS13_12383 <- factor(CS13_12383_10.5_rep3$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_10.5_rep3$E10.5_rep3 <- factor(CS13_12383_10.5_rep3$E10.5_rep3, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf10.5_rep3_compare.pdf")
ggplot(as.data.frame(CS13_12383_10.5_rep3),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E10.5_rep3)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E10.5_rep3")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E10.5_rep3")
dev.off()
####

CS13_12383_10.5_rep4 <- read.table("CS13-12383_10.5_rep4.stats", header=FALSE)
colnames(CS13_12383_10.5_rep4) <- c("CS13_12383", "E10.5_rep4", "Frequency")
head(CS13_12383_10.5_rep4)

# specify order in columns by state number
CS13_12383_10.5_rep4$CS13_12383 <- factor(CS13_12383_10.5_rep4$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_10.5_rep4$E10.5_rep4 <- factor(CS13_12383_10.5_rep4$E10.5_rep4, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf10.5_rep4_compare.pdf")
ggplot(as.data.frame(CS13_12383_10.5_rep4),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E10.5_rep4)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E10.5_rep4")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E10.5_rep4")
dev.off()
####

CS13_12383_11.5_rep1 <- read.table("CS13-12383_11.5_rep1.stats", header=FALSE)
colnames(CS13_12383_11.5_rep1) <- c("CS13_12383", "E11.5_rep1", "Frequency")
head(CS13_12383_11.5_rep1)

# specify order in columns by state number
CS13_12383_11.5_rep1$CS13_12383 <- factor(CS13_12383_11.5_rep1$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_11.5_rep1$E11.5_rep1 <- factor(CS13_12383_11.5_rep1$E11.5_rep1, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf11.5_rep1_compare.pdf")
ggplot(as.data.frame(CS13_12383_11.5_rep1),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E11.5_rep1)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E11.5_rep1")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E11.5_rep1")
dev.off()
####

CS13_12383_11.5_rep2 <- read.table("CS13-12383_11.5_rep2.stats", header=FALSE)
colnames(CS13_12383_11.5_rep2) <- c("CS13_12383", "E11.5_rep2", "Frequency")
head(CS13_12383_11.5_rep2)

# specify order in columns by state number
CS13_12383_11.5_rep2$CS13_12383 <- factor(CS13_12383_11.5_rep2$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_11.5_rep2$E11.5_rep2 <- factor(CS13_12383_11.5_rep2$E11.5_rep2, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf11.5_rep2_compare.pdf")
ggplot(as.data.frame(CS13_12383_11.5_rep2),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E11.5_rep2)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E11.5_rep2")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E11.5_rep2")
dev.off()
####

CS13_12383_11.5_rep3 <- read.table("CS13-12383_11.5_rep3.stats", header=FALSE)
colnames(CS13_12383_11.5_rep3) <- c("CS13_12383", "E11.5_rep3", "Frequency")
head(CS13_12383_11.5_rep3)

# specify order in columns by state number
CS13_12383_11.5_rep3$CS13_12383 <- factor(CS13_12383_11.5_rep3$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_11.5_rep3$E11.5_rep3 <- factor(CS13_12383_11.5_rep3$E11.5_rep3, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf11.5_rep3_compare.pdf")
ggplot(as.data.frame(CS13_12383_11.5_rep3),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E11.5_rep3)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E11.5_rep3")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E11.5_rep3")
dev.off()
####

CS13_12383_11.5_rep4 <- read.table("CS13-12383_11.5_rep4.stats", header=FALSE)
colnames(CS13_12383_11.5_rep4) <- c("CS13_12383", "E11.5_rep4", "Frequency")
head(CS13_12383_11.5_rep4)

# specify order in columns by state number
CS13_12383_11.5_rep4$CS13_12383 <- factor(CS13_12383_11.5_rep4$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_11.5_rep4$E11.5_rep4 <- factor(CS13_12383_11.5_rep4$E11.5_rep4, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf11.5_rep4_compare.pdf")
ggplot(as.data.frame(CS13_12383_11.5_rep4),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E11.5_rep4)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E11.5_rep4")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E11.5_rep4")
dev.off()
####

CS13_12383_12.5_rep1 <- read.table("CS13-12383_12.5_rep1.stats", header=FALSE)
colnames(CS13_12383_12.5_rep1) <- c("CS13_12383", "E12.5_rep1", "Frequency")
head(CS13_12383_12.5_rep1)

# specify order in columns by state number
CS13_12383_12.5_rep1$CS13_12383 <- factor(CS13_12383_12.5_rep1$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_12.5_rep1$E12.5_rep1 <- factor(CS13_12383_12.5_rep1$E12.5_rep1, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf12.5_rep1_compare.pdf")
ggplot(as.data.frame(CS13_12383_12.5_rep1),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E12.5_rep1)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E12.5_rep1")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E12.5_rep1")
dev.off()
####

CS13_12383_12.5_rep2 <- read.table("CS13-12383_12.5_rep2.stats", header=FALSE)
colnames(CS13_12383_12.5_rep2) <- c("CS13_12383", "E12.5_rep2", "Frequency")
head(CS13_12383_12.5_rep2)

# specify order in columns by state number
CS13_12383_12.5_rep2$CS13_12383 <- factor(CS13_12383_12.5_rep2$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_12.5_rep2$E12.5_rep2 <- factor(CS13_12383_12.5_rep2$E12.5_rep2, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf12.5_rep2_compare.pdf")
ggplot(as.data.frame(CS13_12383_12.5_rep2),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E12.5_rep2)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E12.5_rep2")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E12.5_rep2")
dev.off()
####

CS13_12383_13.5_rep1 <- read.table("CS13-12383_13.5_rep1.stats", header=FALSE)
colnames(CS13_12383_13.5_rep1) <- c("CS13_12383", "E13.5_rep1", "Frequency")
head(CS13_12383_13.5_rep1)

# specify order in columns by state number
CS13_12383_13.5_rep1$CS13_12383 <- factor(CS13_12383_13.5_rep1$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_13.5_rep1$E13.5_rep1 <- factor(CS13_12383_13.5_rep1$E13.5_rep1, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf13.5_rep1_compare.pdf")
ggplot(as.data.frame(CS13_12383_13.5_rep1),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E13.5_rep1)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E13.5_rep1")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E13.5_rep1")
dev.off()
####

CS13_12383_13.5_rep2 <- read.table("CS13-12383_13.5_rep2.stats", header=FALSE)
colnames(CS13_12383_13.5_rep2) <- c("CS13_12383", "E13.5_rep2", "Frequency")
head(CS13_12383_13.5_rep2)

# specify order in columns by state number
CS13_12383_13.5_rep2$CS13_12383 <- factor(CS13_12383_13.5_rep2$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_13.5_rep2$E13.5_rep2 <- factor(CS13_12383_13.5_rep2$E13.5_rep2, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf13.5_rep2_compare.pdf")
ggplot(as.data.frame(CS13_12383_13.5_rep2),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E13.5_rep2)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E13.5_rep2")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E13.5_rep2")
dev.off()
####

CS13_12383_14.5_rep1 <- read.table("CS13-12383_14.5_rep1.stats", header=FALSE)
colnames(CS13_12383_14.5_rep1) <- c("CS13_12383", "E14.5_rep1", "Frequency")
head(CS13_12383_14.5_rep1)

# specify order in columns by state number
CS13_12383_14.5_rep1$CS13_12383 <- factor(CS13_12383_14.5_rep1$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_14.5_rep1$E14.5_rep1 <- factor(CS13_12383_14.5_rep1$E14.5_rep1, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf14.5_rep1_compare.pdf")
ggplot(as.data.frame(CS13_12383_14.5_rep1),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E14.5_rep1)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E14.5_rep1")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E14.5_rep1")
dev.off()
####

CS13_12383_14.5_rep2 <- read.table("CS13-12383_14.5_rep2.stats", header=FALSE)
colnames(CS13_12383_14.5_rep2) <- c("CS13_12383", "E14.5_rep2", "Frequency")
head(CS13_12383_14.5_rep2)

# specify order in columns by state number
CS13_12383_14.5_rep2$CS13_12383 <- factor(CS13_12383_14.5_rep2$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_14.5_rep2$E14.5_rep2 <- factor(CS13_12383_14.5_rep2$E14.5_rep2, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf14.5_rep2_compare.pdf")
ggplot(as.data.frame(CS13_12383_14.5_rep2),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E14.5_rep2)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E14.5_rep2")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E14.5_rep2")
dev.off()
####

CS13_12383_15.5_rep1 <- read.table("CS13-12383_15.5_rep1.stats", header=FALSE)
colnames(CS13_12383_15.5_rep1) <- c("CS13_12383", "E15.5_rep1", "Frequency")
head(CS13_12383_15.5_rep1)

# specify order in columns by state number
CS13_12383_15.5_rep1$CS13_12383 <- factor(CS13_12383_15.5_rep1$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_15.5_rep1$E15.5_rep1 <- factor(CS13_12383_15.5_rep1$E15.5_rep1, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf15.5_rep1_compare.pdf")
ggplot(as.data.frame(CS13_12383_15.5_rep1),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E15.5_rep1)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E15.5_rep1")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E15.5_rep1")
dev.off()
####

CS13_12383_15.5_rep2 <- read.table("CS13-12383_15.5_rep2.stats", header=FALSE)
colnames(CS13_12383_15.5_rep2) <- c("CS13_12383", "E15.5_rep2", "Frequency")
head(CS13_12383_15.5_rep2)

# specify order in columns by state number
CS13_12383_15.5_rep2$CS13_12383 <- factor(CS13_12383_15.5_rep2$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_15.5_rep2$E15.5_rep2 <- factor(CS13_12383_15.5_rep2$E15.5_rep2, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf15.5_rep2_compare.pdf")
ggplot(as.data.frame(CS13_12383_15.5_rep2),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E15.5_rep2)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E15.5_rep2")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E15.5_rep2")
dev.off()

#### for comparison with hindbrain

CS13_12383_10.5_day_hindbrain_rep1 <- read.table("CS13-12383_10.5_day_hindbrain_rep1.stats", header=FALSE)
colnames(CS13_12383_10.5_day_hindbrain_rep1) <- c("CS13_12383", "E10.5_day_hindbrain_rep1", "Frequency")
head(CS13_12383_10.5_day_hindbrain_rep1)

# specify order in columns by state number
CS13_12383_10.5_day_hindbrain_rep1$CS13_12383 <- factor(CS13_12383_10.5_day_hindbrain_rep1$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_10.5_day_hindbrain_rep1$E10.5_day_hindbrain_rep1 <- factor(CS13_12383_10.5_day_hindbrain_rep1$E10.5_day_hindbrain_rep1, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf10.5_day_hindbrain_rep1_compare.pdf")
ggplot(as.data.frame(CS13_12383_10.5_day_hindbrain_rep1),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E10.5_day_hindbrain_rep1)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E10.5_day_hindbrain_rep1")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E10.5_day_hindbrain_rep1")
dev.off()
####

CS13_12383_10.5_day_hindbrain_rep2 <- read.table("CS13-12383_10.5_day_hindbrain_rep2.stats", header=FALSE)
colnames(CS13_12383_10.5_day_hindbrain_rep2) <- c("CS13_12383", "E10.5_day_hindbrain_rep2", "Frequency")
head(CS13_12383_10.5_day_hindbrain_rep2)

# specify order in columns by state number
CS13_12383_10.5_day_hindbrain_rep2$CS13_12383 <- factor(CS13_12383_10.5_day_hindbrain_rep2$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_10.5_day_hindbrain_rep2$E10.5_day_hindbrain_rep2 <- factor(CS13_12383_10.5_day_hindbrain_rep2$E10.5_day_hindbrain_rep2, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf10.5_day_hindbrain_rep2_compare.pdf")
ggplot(as.data.frame(CS13_12383_10.5_day_hindbrain_rep2),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E10.5_day_hindbrain_rep2)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E10.5_day_hindbrain_rep2")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E10.5_day_hindbrain_rep2")
dev.off()
####

CS13_12383_11.5_day_hindbrain_rep1 <- read.table("CS13-12383_11.5_day_hindbrain_rep1.stats", header=FALSE)
colnames(CS13_12383_11.5_day_hindbrain_rep1) <- c("CS13_12383", "E11.5_day_hindbrain_rep1", "Frequency")
head(CS13_12383_11.5_day_hindbrain_rep1)

# specify order in columns by state number
CS13_12383_11.5_day_hindbrain_rep1$CS13_12383 <- factor(CS13_12383_11.5_day_hindbrain_rep1$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_11.5_day_hindbrain_rep1$E11.5_day_hindbrain_rep1 <- factor(CS13_12383_11.5_day_hindbrain_rep1$E11.5_day_hindbrain_rep1, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf11.5_day_hindbrain_rep1_compare.pdf")
ggplot(as.data.frame(CS13_12383_11.5_day_hindbrain_rep1),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E11.5_day_hindbrain_rep1)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E11.5_day_hindbrain_rep1")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E11.5_day_hindbrain_rep1")
dev.off()
####

CS13_12383_11.5_day_hindbrain_rep2 <- read.table("CS13-12383_11.5_day_hindbrain_rep2.stats", header=FALSE)
colnames(CS13_12383_11.5_day_hindbrain_rep2) <- c("CS13_12383", "E11.5_day_hindbrain_rep2", "Frequency")
head(CS13_12383_11.5_day_hindbrain_rep2)

# specify order in columns by state number
CS13_12383_11.5_day_hindbrain_rep2$CS13_12383 <- factor(CS13_12383_11.5_day_hindbrain_rep2$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_11.5_day_hindbrain_rep2$E11.5_day_hindbrain_rep2 <- factor(CS13_12383_11.5_day_hindbrain_rep2$E11.5_day_hindbrain_rep2, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf11.5_day_hindbrain_rep2_compare.pdf")
ggplot(as.data.frame(CS13_12383_11.5_day_hindbrain_rep2),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E11.5_day_hindbrain_rep2)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E11.5_day_hindbrain_rep2")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E11.5_day_hindbrain_rep2")
dev.off()
####

CS13_12383_12.5_day_hindbrain_rep1 <- read.table("CS13-12383_12.5_day_hindbrain_rep1.stats", header=FALSE)
colnames(CS13_12383_12.5_day_hindbrain_rep1) <- c("CS13_12383", "E12.5_day_hindbrain_rep1", "Frequency")
head(CS13_12383_12.5_day_hindbrain_rep1)

# specify order in columns by state number
CS13_12383_12.5_day_hindbrain_rep1$CS13_12383 <- factor(CS13_12383_12.5_day_hindbrain_rep1$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_12.5_day_hindbrain_rep1$E12.5_day_hindbrain_rep1 <- factor(CS13_12383_12.5_day_hindbrain_rep1$E12.5_day_hindbrain_rep1, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf12.5_day_hindbrain_rep1_compare.pdf")
ggplot(as.data.frame(CS13_12383_12.5_day_hindbrain_rep1),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E12.5_day_hindbrain_rep1)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E12.5_day_hindbrain_rep1")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E12.5_day_hindbrain_rep1")
dev.off()
####

CS13_12383_12.5_day_hindbrain_rep2 <- read.table("CS13-12383_12.5_day_hindbrain_rep2.stats", header=FALSE)
colnames(CS13_12383_12.5_day_hindbrain_rep2) <- c("CS13_12383", "E12.5_day_hindbrain_rep2", "Frequency")
head(CS13_12383_12.5_day_hindbrain_rep2)

# specify order in columns by state number
CS13_12383_12.5_day_hindbrain_rep2$CS13_12383 <- factor(CS13_12383_12.5_day_hindbrain_rep2$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_12.5_day_hindbrain_rep2$E12.5_day_hindbrain_rep2 <- factor(CS13_12383_12.5_day_hindbrain_rep2$E12.5_day_hindbrain_rep2, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf12.5_day_hindbrain_rep2_compare.pdf")
ggplot(as.data.frame(CS13_12383_12.5_day_hindbrain_rep2),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E12.5_day_hindbrain_rep2)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E12.5_day_hindbrain_rep2")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E12.5_day_hindbrain_rep2")
dev.off()
####

CS13_12383_13.5_day_hindbrain_rep1 <- read.table("CS13-12383_13.5_day_hindbrain_rep1.stats", header=FALSE)
colnames(CS13_12383_13.5_day_hindbrain_rep1) <- c("CS13_12383", "E13.5_day_hindbrain_rep1", "Frequency")
head(CS13_12383_13.5_day_hindbrain_rep1)

# specify order in columns by state number
CS13_12383_13.5_day_hindbrain_rep1$CS13_12383 <- factor(CS13_12383_13.5_day_hindbrain_rep1$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_13.5_day_hindbrain_rep1$E13.5_day_hindbrain_rep1 <- factor(CS13_12383_13.5_day_hindbrain_rep1$E13.5_day_hindbrain_rep1, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf13.5_day_hindbrain_rep1_compare.pdf")
ggplot(as.data.frame(CS13_12383_13.5_day_hindbrain_rep1),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E13.5_day_hindbrain_rep1)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E13.5_day_hindbrain_rep1")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E13.5_day_hindbrain_rep1")
dev.off()
####

CS13_12383_13.5_day_hindbrain_rep2 <- read.table("CS13-12383_13.5_day_hindbrain_rep2.stats", header=FALSE)
colnames(CS13_12383_13.5_day_hindbrain_rep2) <- c("CS13_12383", "E13.5_day_hindbrain_rep2", "Frequency")
head(CS13_12383_13.5_day_hindbrain_rep2)

# specify order in columns by state number
CS13_12383_13.5_day_hindbrain_rep2$CS13_12383 <- factor(CS13_12383_13.5_day_hindbrain_rep2$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_13.5_day_hindbrain_rep2$E13.5_day_hindbrain_rep2 <- factor(CS13_12383_13.5_day_hindbrain_rep2$E13.5_day_hindbrain_rep2, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf13.5_day_hindbrain_rep2_compare.pdf")
ggplot(as.data.frame(CS13_12383_13.5_day_hindbrain_rep2),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E13.5_day_hindbrain_rep2)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E13.5_day_hindbrain_rep2")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E13.5_day_hindbrain_rep2")
dev.off()
####

CS13_12383_14.5_day_hindbrain_rep1 <- read.table("CS13-12383_14.5_day_hindbrain_rep1.stats", header=FALSE)
colnames(CS13_12383_14.5_day_hindbrain_rep1) <- c("CS13_12383", "E14.5_day_hindbrain_rep1", "Frequency")
head(CS13_12383_14.5_day_hindbrain_rep1)

# specify order in columns by state number
CS13_12383_14.5_day_hindbrain_rep1$CS13_12383 <- factor(CS13_12383_14.5_day_hindbrain_rep1$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_14.5_day_hindbrain_rep1$E14.5_day_hindbrain_rep1 <- factor(CS13_12383_14.5_day_hindbrain_rep1$E14.5_day_hindbrain_rep1, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf14.5_day_hindbrain_rep1_compare.pdf")
ggplot(as.data.frame(CS13_12383_14.5_day_hindbrain_rep1),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E14.5_day_hindbrain_rep1)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E14.5_day_hindbrain_rep1")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E14.5_day_hindbrain_rep1")
dev.off()
####

CS13_12383_14.5_day_hindbrain_rep2 <- read.table("CS13-12383_14.5_day_hindbrain_rep2.stats", header=FALSE)
colnames(CS13_12383_14.5_day_hindbrain_rep2) <- c("CS13_12383", "E14.5_day_hindbrain_rep2", "Frequency")
head(CS13_12383_14.5_day_hindbrain_rep2)

# specify order in columns by state number
CS13_12383_14.5_day_hindbrain_rep2$CS13_12383 <- factor(CS13_12383_14.5_day_hindbrain_rep2$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_14.5_day_hindbrain_rep2$E14.5_day_hindbrain_rep2 <- factor(CS13_12383_14.5_day_hindbrain_rep2$E14.5_day_hindbrain_rep2, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf14.5_day_hindbrain_rep2_compare.pdf")
ggplot(as.data.frame(CS13_12383_14.5_day_hindbrain_rep2),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E14.5_day_hindbrain_rep2)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E14.5_day_hindbrain_rep2")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E14.5_day_hindbrain_rep2")
dev.off()
####

CS13_12383_15.5_day_hindbrain_rep1 <- read.table("CS13-12383_15.5_day_hindbrain_rep1.stats", header=FALSE)
colnames(CS13_12383_15.5_day_hindbrain_rep1) <- c("CS13_12383", "E15.5_day_hindbrain_rep1", "Frequency")
head(CS13_12383_15.5_day_hindbrain_rep1)

# specify order in columns by state number
CS13_12383_15.5_day_hindbrain_rep1$CS13_12383 <- factor(CS13_12383_15.5_day_hindbrain_rep1$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_15.5_day_hindbrain_rep1$E15.5_day_hindbrain_rep1 <- factor(CS13_12383_15.5_day_hindbrain_rep1$E15.5_day_hindbrain_rep1, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf15.5_day_hindbrain_rep1_compare.pdf")
ggplot(as.data.frame(CS13_12383_15.5_day_hindbrain_rep1),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E15.5_day_hindbrain_rep1)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E15.5_day_hindbrain_rep1")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E15.5_day_hindbrain_rep1")
dev.off()
####

CS13_12383_15.5_day_hindbrain_rep2 <- read.table("CS13-12383_15.5_day_hindbrain_rep2.stats", header=FALSE)
colnames(CS13_12383_15.5_day_hindbrain_rep2) <- c("CS13_12383", "E15.5_day_hindbrain_rep2", "Frequency")
head(CS13_12383_15.5_day_hindbrain_rep2)

# specify order in columns by state number
CS13_12383_15.5_day_hindbrain_rep2$CS13_12383 <- factor(CS13_12383_15.5_day_hindbrain_rep2$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_15.5_day_hindbrain_rep2$E15.5_day_hindbrain_rep2 <- factor(CS13_12383_15.5_day_hindbrain_rep2$E15.5_day_hindbrain_rep2, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf15.5_day_hindbrain_rep2_compare.pdf")
ggplot(as.data.frame(CS13_12383_15.5_day_hindbrain_rep2),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E15.5_day_hindbrain_rep2)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E15.5_day_hindbrain_rep2")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E15.5_day_hindbrain_rep2")
dev.off()

####


###
# Intersect of just HOXA LCR region
for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_9.5_rep1_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_9.5_day_embryonic_Rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep1_HOX.stats" >> make_CS13-12383_9.5_rep1_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_9.5_rep2_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_9.5_day_embryonic_Rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_9.5_rep2_HOX.stats" >> make_CS13-12383_9.5_rep2_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_10.5_rep1_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_10.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep1_HOX.stats" >> make_CS13-12383_10.5_rep1_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_10.5_rep2_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_10.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_rep2_HOX.stats" >> make_CS13-12383_10.5_rep2_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_11.5_rep1_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_11.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep1_HOX.stats" >> make_CS13-12383_11.5_rep1_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_11.5_rep2_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_11.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_rep2_HOX.stats" >> make_CS13-12383_11.5_rep2_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_12.5_rep1_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_12.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep1_HOX.stats" >> make_CS13-12383_12.5_rep1_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_12.5_rep2_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_12.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_rep2_HOX.stats" >> make_CS13-12383_12.5_rep2_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_13.5_rep1_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_13.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep1_HOX.stats" >> make_CS13-12383_13.5_rep1_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_13.5_rep2_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_13.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_rep2_HOX.stats" >> make_CS13-12383_13.5_rep2_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_14.5_rep1_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_14.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep1_HOX.stats" >> make_CS13-12383_14.5_rep1_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_14.5_rep2_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_14.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_rep2_HOX.stats" >> make_CS13-12383_14.5_rep2_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_15.5_rep1_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_15.5_day_embryonic_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep1_HOX.stats" >> make_CS13-12383_15.5_rep1_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_15.5_rep2_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_15.5_day_embryonic_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_rep2_HOX.stats" >> make_CS13-12383_15.5_rep2_HOX.sh
done

##
for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_10.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep1_HOX.stats" >> make_CS13-12383_10.5_day_hindbrain_rep1_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_10.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_10.5_day_hindbrain_rep2_HOX.stats" >> make_CS13-12383_10.5_day_hindbrain_rep2_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_11.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep1_HOX.stats" >> make_CS13-12383_11.5_day_hindbrain_rep1_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_11.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_11.5_day_hindbrain_rep2_HOX.stats" >> make_CS13-12383_11.5_day_hindbrain_rep2_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_12.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep1_HOX.stats" >> make_CS13-12383_12.5_day_hindbrain_rep1_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_12.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_12.5_day_hindbrain_rep2_HOX.stats" >> make_CS13-12383_12.5_day_hindbrain_rep2_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_13.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep1_HOX.stats" >> make_CS13-12383_13.5_day_hindbrain_rep1_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_13.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_13.5_day_hindbrain_rep2_HOX.stats" >> make_CS13-12383_13.5_day_hindbrain_rep2_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_14.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep1_HOX.stats" >> make_CS13-12383_14.5_day_hindbrain_rep1_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_14.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_14.5_day_hindbrain_rep2_HOX.stats" >> make_CS13-12383_14.5_day_hindbrain_rep2_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_15.5_day_hindbrain_rep1.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep1_HOX.stats" >> make_CS13-12383_15.5_day_hindbrain_rep1_HOX.sh
done

for STATE in 1_TssA 2_TssFlnk 3_TssFlnkU 4_TssFlnkD 5_Tx 6_TxWk 7_EnhG1 8_EnhG2 9_EnhA1 10_EnhA2 11_EnhWk 12_ZNFRpts 13_Het 14_TssBiv 15_EnhBiv 16_ReprPC 17_ReprPCWk 18_Quies;
do
    echo "cat CS13-12383_1_TssA_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"1_TssA "$STATE" \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats 
cat CS13-12383_2_TssFlnk_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"2_TssFlnk "$STATE" \"\`wc -l\`  >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_3_TssFlnkU_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"3_TssFlnkU "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_4_TssFlnkD_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"4_TssFlnkD "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_5_Tx_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"5_Tx "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_6_TxWk_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"6_TxWk "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_7_EnhG1_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"7_EnhG1 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_8_EnhG2_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"8_EnhG2 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_9_EnhA1_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"9_EnhA1 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_10_EnhA2_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"10_EnhA2 "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_11_EnhWk_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"11_EnhWk "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_12_ZNFRpts_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"12_ZNFRpts "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_13_Het_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"13_Het "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_14_TssBiv_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"14_TssBiv "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_15_EnhBiv_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"15_EnhBiv "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_16_ReprPC_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"16_ReprPC "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_17_ReprPCWk_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"17_ReprPCWk "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats
cat CS13-12383_18_Quies_successful_intersect_on_15.5_day_hindbrain_rep2.bed | awk '{if ( \$2 >= 25400000 && \$3 <= 26000000) print \$0}' | grep chr7 | cut -f 8 | grep "$STATE" | echo \"18_Quies "$STATE" \"\`wc -l\`   >> CS13-12383_15.5_day_hindbrain_rep2_HOX.stats" >> make_CS13-12383_15.5_day_hindbrain_rep2_HOX.sh
done

## Plot
setwd("/Users/awilderman/Documents/GitHub/Alluvial_plot_creation/")
library("ggplot2")
library("ggalluvial")

# info that may be useful
states <- c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNF/Rpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"  )
colors_by_state <- c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")

# load data
CS13_12383_9.5_rep1_HOX <- read.table("CS13-12383_9.5_rep1_HOX.stats", header=FALSE)
colnames(CS13_12383_9.5_rep1_HOX) <- c("CS13_12383", "E9.5_rep1_HOX", "Frequency")
head(CS13_12383_9.5_rep1_HOX)

# specify order in columns by state number
CS13_12383_9.5_rep1_HOX$CS13_12383 <- factor(CS13_12383_9.5_rep1_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_9.5_rep1_HOX$E9.5_rep1_HOX <- factor(CS13_12383_9.5_rep1_HOX$E9.5_rep1_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscfE9.5_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_9.5_rep1_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E9.5_rep1_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E9.5_rep1_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E9.5_rep1_HOX")
dev.off()
####

CS13_12383_9.5_rep2_HOX <- read.table("CS13-12383_9.5_rep2_HOX.stats", header=FALSE)
colnames(CS13_12383_9.5_rep2_HOX) <- c("CS13_12383", "E9.5_rep2_HOX", "Frequency")
head(CS13_12383_9.5_rep2_HOX)

# specify order in columns by state number
CS13_12383_9.5_rep2_HOX$CS13_12383 <- factor(CS13_12383_9.5_rep2_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_9.5_rep2_HOX$E9.5_rep2_HOX <- factor(CS13_12383_9.5_rep2_HOX$E9.5_rep2_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscfE9.5_rep2_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_9.5_rep2_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E9.5_rep2_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E9.5_rep2_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E9.5_rep2_HOX")
dev.off()
####


CS13_12383_10.5_rep1_HOX <- read.table("CS13-12383_10.5_rep1_HOX.stats", header=FALSE)
colnames(CS13_12383_10.5_rep1_HOX) <- c("CS13_12383", "E10.5_rep1_HOX", "Frequency")
head(CS13_12383_10.5_rep1_HOX)

# specify order in columns by state number
CS13_12383_10.5_rep1_HOX$CS13_12383 <- factor(CS13_12383_10.5_rep1_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_10.5_rep1_HOX$E10.5_rep1_HOX <- factor(CS13_12383_10.5_rep1_HOX$E10.5_rep1_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf10.5_rep1_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_10.5_rep1_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E10.5_rep1_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E10.5_rep1_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E10.5_rep1_HOX")
dev.off()
####

CS13_12383_10.5_rep2_HOX <- read.table("CS13-12383_10.5_rep2_HOX.stats", header=FALSE)
colnames(CS13_12383_10.5_rep2_HOX) <- c("CS13_12383", "E10.5_rep2_HOX", "Frequency")
head(CS13_12383_10.5_rep2_HOX)

# specify order in columns by state number
CS13_12383_10.5_rep2_HOX$CS13_12383 <- factor(CS13_12383_10.5_rep2_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_10.5_rep2_HOX$E10.5_rep2_HOX <- factor(CS13_12383_10.5_rep2_HOX$E10.5_rep2_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf10.5_rep2_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_10.5_rep2_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E10.5_rep2_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E10.5_rep2_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E10.5_rep2_HOX")
dev.off()

CS13_12383_11.5_rep1_HOX <- read.table("CS13-12383_11.5_rep1_HOX.stats", header=FALSE)
colnames(CS13_12383_11.5_rep1_HOX) <- c("CS13_12383", "E11.5_rep1_HOX", "Frequency")
head(CS13_12383_11.5_rep1_HOX)

# specify order in columns by state number
CS13_12383_11.5_rep1_HOX$CS13_12383 <- factor(CS13_12383_11.5_rep1_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_11.5_rep1_HOX$E11.5_rep1_HOX <- factor(CS13_12383_11.5_rep1_HOX$E11.5_rep1_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf11.5_rep1_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_11.5_rep1_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E11.5_rep1_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E11.5_rep1_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E11.5_rep1_HOX")
dev.off()
####

CS13_12383_11.5_rep2_HOX <- read.table("CS13-12383_11.5_rep2_HOX.stats", header=FALSE)
colnames(CS13_12383_11.5_rep2_HOX) <- c("CS13_12383", "E11.5_rep2_HOX", "Frequency")
head(CS13_12383_11.5_rep2_HOX)

# specify order in columns by state number
CS13_12383_11.5_rep2_HOX$CS13_12383 <- factor(CS13_12383_11.5_rep2_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_11.5_rep2_HOX$E11.5_rep2_HOX <- factor(CS13_12383_11.5_rep2_HOX$E11.5_rep2_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf11.5_rep2_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_11.5_rep2_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E11.5_rep2_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E11.5_rep2_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E11.5_rep2_HOX")
dev.off()

CS13_12383_12.5_rep1_HOX <- read.table("CS13-12383_12.5_rep1_HOX.stats", header=FALSE)
colnames(CS13_12383_12.5_rep1_HOX) <- c("CS13_12383", "E12.5_rep1_HOX", "Frequency")
head(CS13_12383_12.5_rep1_HOX)

# specify order in columns by state number
CS13_12383_12.5_rep1_HOX$CS13_12383 <- factor(CS13_12383_12.5_rep1_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_12.5_rep1_HOX$E12.5_rep1_HOX <- factor(CS13_12383_12.5_rep1_HOX$E12.5_rep1_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf12.5_rep1_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_12.5_rep1_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E12.5_rep1_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E12.5_rep1_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E12.5_rep1_HOX")
dev.off()
####

CS13_12383_12.5_rep2_HOX <- read.table("CS13-12383_12.5_rep2_HOX.stats", header=FALSE)
colnames(CS13_12383_12.5_rep2_HOX) <- c("CS13_12383", "E12.5_rep2_HOX", "Frequency")
head(CS13_12383_12.5_rep2_HOX)

# specify order in columns by state number
CS13_12383_12.5_rep2_HOX$CS13_12383 <- factor(CS13_12383_12.5_rep2_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_12.5_rep2_HOX$E12.5_rep2_HOX <- factor(CS13_12383_12.5_rep2_HOX$E12.5_rep2_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf12.5_rep2_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_12.5_rep2_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E12.5_rep2_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E12.5_rep2_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E12.5_rep2_HOX")
dev.off()

CS13_12383_13.5_rep1_HOX <- read.table("CS13-12383_13.5_rep1_HOX.stats", header=FALSE)
colnames(CS13_12383_13.5_rep1_HOX) <- c("CS13_12383", "E13.5_rep1_HOX", "Frequency")
head(CS13_12383_13.5_rep1_HOX)

# specify order in columns by state number
CS13_12383_13.5_rep1_HOX$CS13_12383 <- factor(CS13_12383_13.5_rep1_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_13.5_rep1_HOX$E13.5_rep1_HOX <- factor(CS13_12383_13.5_rep1_HOX$E13.5_rep1_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf13.5_rep1_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_13.5_rep1_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E13.5_rep1_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E13.5_rep1_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E13.5_rep1_HOX")
dev.off()
####

CS13_12383_13.5_rep2_HOX <- read.table("CS13-12383_13.5_rep2_HOX.stats", header=FALSE)
colnames(CS13_12383_13.5_rep2_HOX) <- c("CS13_12383", "E13.5_rep2_HOX", "Frequency")
head(CS13_12383_13.5_rep2_HOX)

# specify order in columns by state number
CS13_12383_13.5_rep2_HOX$CS13_12383 <- factor(CS13_12383_13.5_rep2_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_13.5_rep2_HOX$E13.5_rep2_HOX <- factor(CS13_12383_13.5_rep2_HOX$E13.5_rep2_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf13.5_rep2_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_13.5_rep2_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E13.5_rep2_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E13.5_rep2_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E13.5_rep2_HOX")
dev.off()

CS13_12383_14.5_rep1_HOX <- read.table("CS13-12383_14.5_rep1_HOX.stats", header=FALSE)
colnames(CS13_12383_14.5_rep1_HOX) <- c("CS13_12383", "E14.5_rep1_HOX", "Frequency")
head(CS13_12383_14.5_rep1_HOX)

# specify order in columns by state number
CS13_12383_14.5_rep1_HOX$CS13_12383 <- factor(CS13_12383_14.5_rep1_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_14.5_rep1_HOX$E14.5_rep1_HOX <- factor(CS13_12383_14.5_rep1_HOX$E14.5_rep1_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf14.5_rep1_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_14.5_rep1_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E14.5_rep1_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E14.5_rep1_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E14.5_rep1_HOX")
dev.off()
####

CS13_12383_14.5_rep2_HOX <- read.table("CS13-12383_14.5_rep2_HOX.stats", header=FALSE)
colnames(CS13_12383_14.5_rep2_HOX) <- c("CS13_12383", "E14.5_rep2_HOX", "Frequency")
head(CS13_12383_14.5_rep2_HOX)

# specify order in columns by state number
CS13_12383_14.5_rep2_HOX$CS13_12383 <- factor(CS13_12383_14.5_rep2_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_14.5_rep2_HOX$E14.5_rep2_HOX <- factor(CS13_12383_14.5_rep2_HOX$E14.5_rep2_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf14.5_rep2_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_14.5_rep2_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E14.5_rep2_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E14.5_rep2_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E14.5_rep2_HOX")
dev.off()

CS13_12383_15.5_rep1_HOX <- read.table("CS13-12383_15.5_rep1_HOX.stats", header=FALSE)
colnames(CS13_12383_15.5_rep1_HOX) <- c("CS13_12383", "E15.5_rep1_HOX", "Frequency")
head(CS13_12383_15.5_rep1_HOX)

# specify order in columns by state number
CS13_12383_15.5_rep1_HOX$CS13_12383 <- factor(CS13_12383_15.5_rep1_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_15.5_rep1_HOX$E15.5_rep1_HOX <- factor(CS13_12383_15.5_rep1_HOX$E15.5_rep1_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf15.5_rep1_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_15.5_rep1_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E15.5_rep1_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E15.5_rep1_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E15.5_rep1_HOX")
dev.off()
####

CS13_12383_15.5_rep2_HOX <- read.table("CS13-12383_15.5_rep2_HOX.stats", header=FALSE)
colnames(CS13_12383_15.5_rep2_HOX) <- c("CS13_12383", "E15.5_rep2_HOX", "Frequency")
head(CS13_12383_15.5_rep2_HOX)

# specify order in columns by state number
CS13_12383_15.5_rep2_HOX$CS13_12383 <- factor(CS13_12383_15.5_rep2_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_15.5_rep2_HOX$E15.5_rep2_HOX <- factor(CS13_12383_15.5_rep2_HOX$E15.5_rep2_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf15.5_rep2_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_15.5_rep2_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E15.5_rep2_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E15.5_rep2_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E15.5_rep2_HOX")
dev.off()

###
CS13_12383_10.5_day_hindbrain_rep1_HOX <- read.table("CS13-12383_10.5_day_hindbrain_rep1_HOX.stats", header=FALSE)
colnames(CS13_12383_10.5_day_hindbrain_rep1_HOX) <- c("CS13_12383", "E10.5_day_hindbrain_rep1_HOX", "Frequency")
head(CS13_12383_10.5_day_hindbrain_rep1_HOX)

# specify order in columns by state number
CS13_12383_10.5_day_hindbrain_rep1_HOX$CS13_12383 <- factor(CS13_12383_10.5_day_hindbrain_rep1_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_10.5_day_hindbrain_rep1_HOX$E10.5_day_hindbrain_rep1_HOX <- factor(CS13_12383_10.5_day_hindbrain_rep1_HOX$E10.5_day_hindbrain_rep1_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf10.5_day_hindbrain_rep1_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_10.5_day_hindbrain_rep1_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E10.5_day_hindbrain_rep1_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E10.5_day_hindbrain_rep1_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E10.5_day_hindbrain_rep1_HOX")
dev.off()
####

CS13_12383_10.5_day_hindbrain_rep2_HOX <- read.table("CS13-12383_10.5_day_hindbrain_rep2_HOX.stats", header=FALSE)
colnames(CS13_12383_10.5_day_hindbrain_rep2_HOX) <- c("CS13_12383", "E10.5_day_hindbrain_rep2_HOX", "Frequency")
head(CS13_12383_10.5_day_hindbrain_rep2_HOX)

# specify order in columns by state number
CS13_12383_10.5_day_hindbrain_rep2_HOX$CS13_12383 <- factor(CS13_12383_10.5_day_hindbrain_rep2_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_10.5_day_hindbrain_rep2_HOX$E10.5_day_hindbrain_rep2_HOX <- factor(CS13_12383_10.5_day_hindbrain_rep2_HOX$E10.5_day_hindbrain_rep2_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf10.5_day_hindbrain_rep2_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_10.5_day_hindbrain_rep2_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E10.5_day_hindbrain_rep2_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E10.5_day_hindbrain_rep2_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E10.5_day_hindbrain_rep2_HOX")
dev.off()

CS13_12383_11.5_day_hindbrain_rep1_HOX <- read.table("CS13-12383_11.5_day_hindbrain_rep1_HOX.stats", header=FALSE)
colnames(CS13_12383_11.5_day_hindbrain_rep1_HOX) <- c("CS13_12383", "E11.5_day_hindbrain_rep1_HOX", "Frequency")
head(CS13_12383_11.5_day_hindbrain_rep1_HOX)

# specify order in columns by state number
CS13_12383_11.5_day_hindbrain_rep1_HOX$CS13_12383 <- factor(CS13_12383_11.5_day_hindbrain_rep1_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_11.5_day_hindbrain_rep1_HOX$E11.5_day_hindbrain_rep1_HOX <- factor(CS13_12383_11.5_day_hindbrain_rep1_HOX$E11.5_day_hindbrain_rep1_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf11.5_day_hindbrain_rep1_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_11.5_day_hindbrain_rep1_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E11.5_day_hindbrain_rep1_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E11.5_day_hindbrain_rep1_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E11.5_day_hindbrain_rep1_HOX")
dev.off()
####

CS13_12383_11.5_day_hindbrain_rep2_HOX <- read.table("CS13-12383_11.5_day_hindbrain_rep2_HOX.stats", header=FALSE)
colnames(CS13_12383_11.5_day_hindbrain_rep2_HOX) <- c("CS13_12383", "E11.5_day_hindbrain_rep2_HOX", "Frequency")
head(CS13_12383_11.5_day_hindbrain_rep2_HOX)

# specify order in columns by state number
CS13_12383_11.5_day_hindbrain_rep2_HOX$CS13_12383 <- factor(CS13_12383_11.5_day_hindbrain_rep2_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_11.5_day_hindbrain_rep2_HOX$E11.5_day_hindbrain_rep2_HOX <- factor(CS13_12383_11.5_day_hindbrain_rep2_HOX$E11.5_day_hindbrain_rep2_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf11.5_day_hindbrain_rep2_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_11.5_day_hindbrain_rep2_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E11.5_day_hindbrain_rep2_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E11.5_day_hindbrain_rep2_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E11.5_day_hindbrain_rep2_HOX")
dev.off()

CS13_12383_12.5_day_hindbrain_rep1_HOX <- read.table("CS13-12383_12.5_day_hindbrain_rep1_HOX.stats", header=FALSE)
colnames(CS13_12383_12.5_day_hindbrain_rep1_HOX) <- c("CS13_12383", "E12.5_day_hindbrain_rep1_HOX", "Frequency")
head(CS13_12383_12.5_day_hindbrain_rep1_HOX)

# specify order in columns by state number
CS13_12383_12.5_day_hindbrain_rep1_HOX$CS13_12383 <- factor(CS13_12383_12.5_day_hindbrain_rep1_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_12.5_day_hindbrain_rep1_HOX$E12.5_day_hindbrain_rep1_HOX <- factor(CS13_12383_12.5_day_hindbrain_rep1_HOX$E12.5_day_hindbrain_rep1_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf12.5_day_hindbrain_rep1_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_12.5_day_hindbrain_rep1_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E12.5_day_hindbrain_rep1_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E12.5_day_hindbrain_rep1_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E12.5_day_hindbrain_rep1_HOX")
dev.off()
####

CS13_12383_12.5_day_hindbrain_rep2_HOX <- read.table("CS13-12383_12.5_day_hindbrain_rep2_HOX.stats", header=FALSE)
colnames(CS13_12383_12.5_day_hindbrain_rep2_HOX) <- c("CS13_12383", "E12.5_day_hindbrain_rep2_HOX", "Frequency")
head(CS13_12383_12.5_day_hindbrain_rep2_HOX)

# specify order in columns by state number
CS13_12383_12.5_day_hindbrain_rep2_HOX$CS13_12383 <- factor(CS13_12383_12.5_day_hindbrain_rep2_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_12.5_day_hindbrain_rep2_HOX$E12.5_day_hindbrain_rep2_HOX <- factor(CS13_12383_12.5_day_hindbrain_rep2_HOX$E12.5_day_hindbrain_rep2_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf12.5_day_hindbrain_rep2_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_12.5_day_hindbrain_rep2_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E12.5_day_hindbrain_rep2_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E12.5_day_hindbrain_rep2_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E12.5_day_hindbrain_rep2_HOX")
dev.off()

CS13_12383_13.5_day_hindbrain_rep1_HOX <- read.table("CS13-12383_13.5_day_hindbrain_rep1_HOX.stats", header=FALSE)
colnames(CS13_12383_13.5_day_hindbrain_rep1_HOX) <- c("CS13_12383", "E13.5_day_hindbrain_rep1_HOX", "Frequency")
head(CS13_12383_13.5_day_hindbrain_rep1_HOX)

# specify order in columns by state number
CS13_12383_13.5_day_hindbrain_rep1_HOX$CS13_12383 <- factor(CS13_12383_13.5_day_hindbrain_rep1_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_13.5_day_hindbrain_rep1_HOX$E13.5_day_hindbrain_rep1_HOX <- factor(CS13_12383_13.5_day_hindbrain_rep1_HOX$E13.5_day_hindbrain_rep1_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf13.5_day_hindbrain_rep1_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_13.5_day_hindbrain_rep1_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E13.5_day_hindbrain_rep1_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E13.5_day_hindbrain_rep1_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E13.5_day_hindbrain_rep1_HOX")
dev.off()
####

CS13_12383_13.5_day_hindbrain_rep2_HOX <- read.table("CS13-12383_13.5_day_hindbrain_rep2_HOX.stats", header=FALSE)
colnames(CS13_12383_13.5_day_hindbrain_rep2_HOX) <- c("CS13_12383", "E13.5_day_hindbrain_rep2_HOX", "Frequency")
head(CS13_12383_13.5_day_hindbrain_rep2_HOX)

# specify order in columns by state number
CS13_12383_13.5_day_hindbrain_rep2_HOX$CS13_12383 <- factor(CS13_12383_13.5_day_hindbrain_rep2_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_13.5_day_hindbrain_rep2_HOX$E13.5_day_hindbrain_rep2_HOX <- factor(CS13_12383_13.5_day_hindbrain_rep2_HOX$E13.5_day_hindbrain_rep2_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf13.5_day_hindbrain_rep2_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_13.5_day_hindbrain_rep2_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E13.5_day_hindbrain_rep2_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E13.5_day_hindbrain_rep2_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E13.5_day_hindbrain_rep2_HOX")
dev.off()

CS13_12383_14.5_day_hindbrain_rep1_HOX <- read.table("CS13-12383_14.5_day_hindbrain_rep1_HOX.stats", header=FALSE)
colnames(CS13_12383_14.5_day_hindbrain_rep1_HOX) <- c("CS13_12383", "E14.5_day_hindbrain_rep1_HOX", "Frequency")
head(CS13_12383_14.5_day_hindbrain_rep1_HOX)

# specify order in columns by state number
CS13_12383_14.5_day_hindbrain_rep1_HOX$CS13_12383 <- factor(CS13_12383_14.5_day_hindbrain_rep1_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_14.5_day_hindbrain_rep1_HOX$E14.5_day_hindbrain_rep1_HOX <- factor(CS13_12383_14.5_day_hindbrain_rep1_HOX$E14.5_day_hindbrain_rep1_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf14.5_day_hindbrain_rep1_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_14.5_day_hindbrain_rep1_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E14.5_day_hindbrain_rep1_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E14.5_day_hindbrain_rep1_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E14.5_day_hindbrain_rep1_HOX")
dev.off()
####

CS13_12383_14.5_day_hindbrain_rep2_HOX <- read.table("CS13-12383_14.5_day_hindbrain_rep2_HOX.stats", header=FALSE)
colnames(CS13_12383_14.5_day_hindbrain_rep2_HOX) <- c("CS13_12383", "E14.5_day_hindbrain_rep2_HOX", "Frequency")
head(CS13_12383_14.5_day_hindbrain_rep2_HOX)

# specify order in columns by state number
CS13_12383_14.5_day_hindbrain_rep2_HOX$CS13_12383 <- factor(CS13_12383_14.5_day_hindbrain_rep2_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_14.5_day_hindbrain_rep2_HOX$E14.5_day_hindbrain_rep2_HOX <- factor(CS13_12383_14.5_day_hindbrain_rep2_HOX$E14.5_day_hindbrain_rep2_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf14.5_day_hindbrain_rep2_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_14.5_day_hindbrain_rep2_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E14.5_day_hindbrain_rep2_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E14.5_day_hindbrain_rep2_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E14.5_day_hindbrain_rep2_HOX")
dev.off()

CS13_12383_15.5_day_hindbrain_rep1_HOX <- read.table("CS13-12383_15.5_day_hindbrain_rep1_HOX.stats", header=FALSE)
colnames(CS13_12383_15.5_day_hindbrain_rep1_HOX) <- c("CS13_12383", "E15.5_day_hindbrain_rep1_HOX", "Frequency")
head(CS13_12383_15.5_day_hindbrain_rep1_HOX)

# specify order in columns by state number
CS13_12383_15.5_day_hindbrain_rep1_HOX$CS13_12383 <- factor(CS13_12383_15.5_day_hindbrain_rep1_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_15.5_day_hindbrain_rep1_HOX$E15.5_day_hindbrain_rep1_HOX <- factor(CS13_12383_15.5_day_hindbrain_rep1_HOX$E15.5_day_hindbrain_rep1_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf15.5_day_hindbrain_rep1_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_15.5_day_hindbrain_rep1_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E15.5_day_hindbrain_rep1_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E15.5_day_hindbrain_rep1_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E15.5_day_hindbrain_rep1_HOX")
dev.off()
####

CS13_12383_15.5_day_hindbrain_rep2_HOX <- read.table("CS13-12383_15.5_day_hindbrain_rep2_HOX.stats", header=FALSE)
colnames(CS13_12383_15.5_day_hindbrain_rep2_HOX) <- c("CS13_12383", "E15.5_day_hindbrain_rep2_HOX", "Frequency")
head(CS13_12383_15.5_day_hindbrain_rep2_HOX)

# specify order in columns by state number
CS13_12383_15.5_day_hindbrain_rep2_HOX$CS13_12383 <- factor(CS13_12383_15.5_day_hindbrain_rep2_HOX$CS13_12383, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
CS13_12383_15.5_day_hindbrain_rep2_HOX$E15.5_day_hindbrain_rep2_HOX <- factor(CS13_12383_15.5_day_hindbrain_rep2_HOX$E15.5_day_hindbrain_rep2_HOX, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

# Plot
pdf("CS13-12383_mscf15.5_day_hindbrain_rep2_HOX_compare.pdf")
ggplot(as.data.frame(CS13_12383_15.5_day_hindbrain_rep2_HOX),
       aes(y = Frequency, axis1 = CS13_12383, axis2 = E15.5_day_hindbrain_rep2_HOX)) +
  geom_alluvium(aes(fill = CS13_12383), width = 1/12) +
  geom_stratum(width = 1/12) +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("CS13-12383", "E15.5_day_hindbrain_rep2_HOX")) +
  scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
  ggtitle("Chromatin state composition, CS13_12383 E15.5_day_hindbrain_rep2_HOX")
dev.off()



# Dotplots to show which states are most similar between comparisons

setwd("/Users/awilderman/Documents/GitHub/Alluvial_plot_creation/")
library("ggplot2")
library("ggalluvial")

# info that may be useful
#states <- c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNF/Rpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"  )
#colors_by_state <- c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")

transitions <- read.table("CS13-12383_E11.5_reps_for_samestate_dotplot.txt", header=TRUE)
transitions$State <- factor(transitions$State, levels =c( "1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk" ,  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))

p <-  ggplot(transitions, aes(x=State, y=Percent_same)) +
	geom_boxplot(aes(fill=State)) +
	scale_fill_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
	geom_dotplot(binaxis='y', stackdir='center', dotsize=0.5) +
	theme(axis.text.x=element_text(angle=45, vjust=0.4))

### Lineplot
test_plot <- read.table("CS13_12383_fraction_lineplot_test.txt", header=TRUE)
test_plot$State <- factor(test_plot$State, levels=c("1_TssA" , "2_TssFlnk" , "3_TssFlnkU" , "4_TssFlnkD" , "5_Tx" , "6_TxWk", "7_EnhG1" , "8_EnhG2" , "9_EnhA1" , "10_EnhA2" , "11_EnhWk",  "12_ZNFRpts" , "13_Het" ,  "14_TssBiv" , "15_EnhBiv", "16_ReprPC" , "17_ReprPCWk" , "18_Quies"))
test_plot$Stage <- as.numeric(as.vector(test_plot$Stage))

#+++++++++++++++++++++++++
# Function to calculate the mean and the standard deviation
  # for each group
#+++++++++++++++++++++++++
# data : a data frame
# varname : the name of a column containing the variable
  #to be summariezed
# groupnames : vector of column names to be used as
  # grouping variables
data_summary <- function(data, varname, groupnames){
  require(plyr)
  summary_func <- function(x, col){
    c(mean = mean(x[[col]], na.rm=TRUE),
      sd = sd(x[[col]], na.rm=TRUE))
  }
  data_sum<-ddply(data, groupnames, .fun=summary_func,
                  varname)
  data_sum <- rename(data_sum, c("mean" = varname))
 return(data_sum)
}

pt_bars <- data_summary(test_plot, varname="Fraction_of_total_bp_overlap", 
                    groupnames=c("State", "Stage"))
head(pt_bars)

ggplot(data=pt_bars, aes(x=Stage, y=Fraction_of_total_bp_overlap, group=State, color=State)) +
geom_errorbar(aes(ymin=Fraction_of_total_bp_overlap-sd, ymax=Fraction_of_total_bp_overlap+sd), width=.1) +
geom_line(aes(color=State)) +
scale_color_manual(values=c("#FF0000" , "#FF4500" , "#FF4500" , "#FF4500" , "#008000" , "#006400" , "#ADFF2F" , "#ADFF2F" , "#FFA500" , "#FFA500" , "#FFFF00" , "#66CDAA" , "#AFEEEE" , "#CD5C5C" , "#BDB76B" , "#C0C0C0" , "#DCDCDC" , "#FFFFFF")) +
geom_point(aes(shape=State, color=State), size=3) +
scale_shape_manual(values=c(16, 16, 17, 15, 16, 16, 16, 17, 16, 17, 16, 16, 16, 16, 16, 16, 16, 16))+
scale_y_continuous(name="Fraction of mouse bp of same State overlapping total human lifted bp of State", breaks=seq(0, 100, 10))





